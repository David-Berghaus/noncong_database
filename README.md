# Database of modular forms of Noncongruence Subgroups of PSL(2,&#8484;)
## Development status
### Genus zero

| Index  | Amount of computed passports / Total amount of passports |
| ------------- | ------------- |
| 7 | 3/3 |
| 8 | 1/1 |
| 9 | 9/9 |
| 10 | 9/9 |
| 11 | 6/6 |
| 12 | 23/27 |
| 13 | 22/23 |
| 14 | 21/29 |
| 15 | 54/62 |
| 16 | 36/65 |
| 17 | 16/35 |

The database currently contains 200 representatives of genus zero noncongruence subgroups. For each of these subgroups we have rigorously computed q-expansions of the Hauptmodul
and all modular forms and cuspforms up to and including weight 6 up to the 50th order. We also include numerical expressions to construct the spaces of Eisenstein series to around 1000 digits precision as well as floating point expressions of the q-expansions, limited to 100 digits per coefficients to save storage space.

### Genus one

| Index  | Amount of computed passports / Total amount of passports |
| ------------- | ------------- |
| 9 | 1/1 |
| 10 | 1/1 |
| 11 | 0/0 |
| 12 | 2/3 |
| 13 | 1/1 |
| 14 | 1/2 |
| 15 | 6/9 |
| 16 | 7/9 |
| 17 | 1/2 |

The database currently contains 20 representatives of genus one noncongruence subgroups. For each of these subgroups we have computed q-expansions of the Hauptmodul
and all modular forms and cuspforms up to and including weight 6. The order of the q-expansions is not fixed and depends on the amount of coefficients that could be recognized using the LLL algorithm. We also include numerical expressions to construct the spaces of Eisenstein series to around 1000 digits precision as well as floating point expressions of the q-expansions, limited to 100 digits per coefficients to save storage space. Note that we have not yet computed the curves for genus one.
## Requirements
Loading the database requires [SageMath](https://www.sagemath.org/) version 9.2, although other versions of Sage might work as well.
## Database structure
The folders of this repository represent the indices of the subgroups and the subfolders correspond to the genera. Each database entry is labeled by the signature of the
corresponding subgroup which is of the form (h, g, n<sub>c</sub>, e<sub>2</sub>, e<sub>3</sub>) for which the variables are given by:
- h: index
- g: genus
- n<sub>c</sub>: amount of cusps
- e<sub>2</sub>: amount of elliptic points of order two
- e<sub>3</sub>: amount of elliptic points of order three

Each database entry contains the following information (for more background on the notation, please checkout *(add link to paper here once available)*):
```
├── G: Instance of subgroup representative as a Sage subgroup
├── Kv: Basefield of curve with specified embedding
├── v: Generator of v as an element of QQbar
├── u: u as an element of QQbar
├── u_str: Expression of u in terms of v as a string
├── curve: Expression of the curve
└── q_expansions
    └── weight: weight of the considered space of modular forms
        ├── hauptmodul_raw: q-expansion of the hauptmodul with coefficients defined over a numberfield
        ├── hauptmodul_pretty: q-expansion of the hauptmodul with coefficients factored conveniently
        ├── hauptmodul_float: q-expansion of the hauptmodul with coefficients given as floating point numbers with rigorous error bounds
        ├── modforms_raw: list of q-expansions of modular forms with coefficients defined over a numberfield
        ├── modforms_pretty: list of q-expansions of modular forms with coefficients defined over a numberfield with coefficients factored conveniently
        ├── modforms_float: list of q-expansions of modular forms with coefficients defined over a numberfield with coefficients given as floating point numbers with rigorous error bounds
        ├── cuspforms_raw: list of q-expansions of cuspforms with coefficients defined over a numberfield
        ├── cuspforms_pretty: list of q-expansions of cuspforms with coefficients defined over a numberfield with coefficients factored conveniently
        ├── cuspforms_float: list of q-expansions of cuspforms with coefficients defined over a numberfield with coefficients given as floating point numbers with rigorous error bounds
        └── eisenstein_basis_factors: list of floating point expressions that create the space of cuspforms
```
## Reliability of the results
For genus zero, all coefficients have been computed using rigorous arithmetic over numberfields or rigorous interval arithmetic. The only exception are the Eisenstein series whose precision we can only estimate heuristically.
For higher genera, the coefficients are non-rigorous (but supported by highly convincing numerical evidence) because they have been guessed using the LLL algorithm.
As an additional verification, we have also compared the numerical values of the rigorous expressions and the Eisenstein series to the results of an independent numerical method to verify that the results match to at least 10 digits precision.

## How to work with the database
(Maybe put this tutorial into a Jupyter script.)  
Start a Sage session and load the file "database.sage":
```python
sage: load("database.sage")
```
### Loading the database
In this example we would like to load all database elements with `index` 7 and 8:
```python
sage: db = load_database(index=[7,8])
```
Note that you can also filter for `genus` and `Kv_degree`.
### Working with database elements
Let us take a closer look at the first entry of the database:
```python
sage: first_el = db[0]
```
#### G
This database entry corresponds to the subgroup `G`:
```python
sage: G = first_el["G"]
sage: G
Arithmetic subgroup with permutations of right cosets
 S2=(1,3)(2,4)(5,7)
 S3=(1,2,3)(4,5,6)
 L=(2,3,4,6,7,5)
 R=(1,4,7,5,6,2)
```
The instance of `G` offers a rich functionality that is documented [here](https://doc.sagemath.org/html/en/reference/arithgroup/sage/modular/arithgroup/arithgroup_perm.html).
#### Kv
The base ring of the curve is given by `Kv`:
```python
sage: first_el["Kv"]
Number Field in v with defining polynomial x^2 - x + 1 with v = 0.50000000000000000? - 0.866025403784439?*I
```
#### curve
We store each polynomial that is of the form p = (p<sub>0</sub>)<sup>n<sub>0</sub></sup>·(p<sub>1</sub>)<sup>n<sub>1</sub></sup>·... as a list of [p<sub>i</sub>, n<sub>i</sub>].
```python
sage: first_el["curve"]["p3_factored_pretty"]
[[x^2 + ((331776*v + 195357360)*u)*x + (62079188631552*v + 1006988320853568)*u^2,
  3],
 [x + (-1866240*v + 3015384)*u, 1]]
sage: first_el["curve"]["pc_factored_pretty"]
[[x + (-145152*v - 3938088)*u, 6]]
```
The Belyi map is therefore given by:
```
B = p_3/p_c = (x^2 + ((331776*v + 195357360)*u)*x + (62079188631552*v + 1006988320853568)*u^2)^3*(x + (-1866240*v + 3015384)*u)/(x + (-145152*v - 3938088)*u)^6
```
where `u` is given by:
```python
sage: first_el["u"]
1/823543
```
For this example, the width of the cusp at infinity is equal to one so we chose `u` to be a rational number. For general examples, `u` can be the N-th root of an expression in `Kv` (where N denotes the width of the cusp at infinity). This expression for `u` is stored in `u_str`.  
To perform arithmetic, we can also work with the polynomials in a raw format in which they are defined over numberfields:
```python
sage: first_el["curve"]["pc_factored_raw"]
[[x - 20736/117649*w - 562584/117649, 6]]
```
#### q_expansions
To load cuspforms of weight 6 in reduced row echelon form we type:
```python
sage: cuspforms_pretty = first_el["q_expansions"][6]["cuspforms_pretty"]
sage: len(cuspforms_pretty)
2
sage: cuspforms_pretty[0].degree()
51
sage: cuspforms_pretty[0].O(5)
q_1 + ((-4143801286656*v + 2701501787700)*u^2)*q_1^3 + ((13258983380236369920*v - 7054265472408117248)*u^3)*q_1^4 + O(q_1^5)
```
Note that we use the notation q<sub>N</sub> = exp(2πi/N) where N denotes the width of the cusp at infinity.  
Again, we can also work with the raw results:
```python
sage: cuspforms_raw = first_el["q_expansions"][6]["cuspforms_raw"]
sage: cuspforms_raw[0].O(5)
q_1 + (-4143801286656/678223072849*w + 2701501787700/678223072849)*q_1^3 + (13258983380236369920/558545864083284007*w - 7054265472408117248/558545864083284007)*q_1^4 + O(q_1^5)
```
We can also load floating-point expressions with precision up to 100 digits. These typically have significantly more terms:
```python
sage: cuspforms_float = first_el["q_expansions"][6]["cuspforms_float"]
sage: cuspforms_float[0].degree()
430
sage: cuspforms_float[0].O(5)
q_1 + (0.?e-1503 + 0.?e-1506*I)*q_1^2 + (0.92830982839797133249121070702083415667008125755282623640625797715576237045907772875093669519171819885? + 5.2912342946458785170550150561839175572288851297931404955197379158407560101961627841472117243763930876?*I)*q_1^3 + (-0.76049937812554431961328876657211559097998541282907746680234162910441229611410518402754977889284532599? - 20.558054716753226736889654983259937385853725510379030564730557479208023306489838212665260243839743545?*I)*q_1^4 + O(q_1^5)
```
Similarly, we can also load the q-expansion of the Hauptmodul and modular forms.  
To construct the Eisenstein series of weight 4 we note that:
```python
sage: G.dimension_eis(4)
2
sage: G.dimension_modular_forms(4)
3
```
The space of Eisenstein series is therefore two-dimensional and can be constructed from the three-dimensional space of modular forms. To get the corresponding basis factors for the first and second Eisenstein series we type:
```python
sage: eis_fact_list = first_el["q_expansions"][4]["eisenstein_basis_factors"]
sage: eis_fact_list
{0: [1,
  0,
1.29649818432976199277868086276234460109117481008681644144073313670685712961782088377493321752806757106368865443485939435447695969721074909479786164118071618377651820107938390118236253616927734386104749986502807639336722412047355490293353452083023216847543682511482434696272944231515260944448767408679473057939292243726372587889416429368558591463834679089546177630194361623470698172107576611284463693961609769016282742054553202544678335950943298004842118309366034510586358536785422123015008242715316315780151625592605519987309617977719675902411447826070144572510746836062469437668590759896170121431177316272834834888032681632673153304851034084101740511217556670570145882497054314920058952212885597510076327329953636976868953028290063352070474157881744350085566186580817904614072310236427070475706757199475415937173602445540295935678355980685093494998956590751892784098758721988888753888472500385103751083653247981873687086966156385616094463069682835933032424182749416473520102410474856284157859014254 - 3.03721731720365264307060433735636126882780682650646550163988668924004610599744048394557033426784208965787585871821812213507393854704909261395749221074562632604234177943343278077904702528736427935263135224534360535648506531874889780445861931290681372159059998963956123292800662931972017853808929834759214901077820593022846983572643743611001443629925722754981107530356323168210971012649746503352214405631226915894475840184027954749807147519288265050591662983801362858402383872990077594394357755864916337555029291371894590405200288935921484820927991675070242278830865057283915878926407368038792299867598097690000059664234694536427968766494778571019419802228762318904528392586008185684728091795941702269868367952035937352981950415828358886770525954470082251084510027941785605230286162006284697134119953016234421686746655355134006563841365456960101247077980165688578201389779673986863179864152299106378472217609630609794259847064658398167415424080276282710600679919563427993041278094305098328452562295381*I],
 1: [0,
  1, 8.99459792423195932503008882973849023082878677162463826482733027859705476195992574631760444492696638512056796393985475252352301266792828854543834224316174701590093117416216923374507348943262801106724563541722904968169430323283136018790444360616320736596468567989535489855432196065702019746064796802463835528925252948984473447550460764877631005868900688837126890926540856826568872090949551764119648067941826625962432155241439361656063840266871069591646491173710974856205890172763394074487437465655352848684249368226697477000052876591759501350406618967391374397614538554849739710676380871833765957827370094515529854854633197159863861861229787357982909414536593513872624392156262273687833087699112976677041348636125193179263046029048791402699706357675492731874643474222579925397441365374014887206351221845002185766928443323143582100268006850080478777104171014205200446732921838658379630192131364581728734370484778133408859637137641015059932939737209654850279031565905210764693666239956354765482675587441 + 0.0126550721550152193461275180723181719534491951104436062568328612051668587749893353497732097261160087069078160779925755088961414106127045525581562175447734430251764240809726365865793626053640178306359639676889316889853544388281204075185775804704450571732941666234981718038666942888321674105753720764483006208782425247092852909821934893171250601512469051147908794804315134653421237921937394376396756002346344548289364933410011647812419644799703443771079859576583901191000993280412532330997649064943715140647928871404956079335500120389967285342053329864612600949512860440534964949552669736682830124944832540704166691526764456056844986986039491071258091584261984299543553496910836744035303371581642375945778486646681640563742479339928482869487719147695867604618545844975744002179285900835951957139216647090097675702811106397972502734933902273733375519615825069036907583912408197494526324943396791294324363424004012754080941602943607665903089760033448451129416949966484761663767199205960457636855234289543*I]}
```
To get a floating-point approximation of the first Eisenstein series we run:
```python
sage: e_0_basis_facts = eis_fact_list[0]
sage: modforms = first_el["q_expansions"][4]["modforms_raw"]
sage: e_0 = sum(modforms[i]*e_0_basis_facts[i] for i in range(len(modforms)))
sage: e_0.O(5)
1 + (1.29649818432976199277868086276234460109117481008681644144073313670685712961782088377493321752806757106368865443485939435447695969721074909479786164118071618377651820107938390118236253616927734386104749986502807639336722412047355490293353452083023216847543682511482434696272944231515260944448767408679473057939292243726372587889416429368558591463834679089546177630194361623470698172107576611284463693961609769016282742054553202544678335950943298004842118309366034510586358536785422123015008242715316315780151625592605519987309617977719675902411447826070144572510746836062469437668590759896170121431177316272834834888032681632673153304851034084101740511217556670570145882497054314920058952212885597510076327329953636976868953028290063352070474157881744350085566186580817904614072310236427070475706757199475415937173602445540295935678355980685093494998956590751892784098758721988888753888472500385103751083653247981873687086966156385616094463069682835933032424182749416473520102410474856284157859014254 - 3.03721731720365264307060433735636126882780682650646550163988668924004610599744048394557033426784208965787585871821812213507393854704909261395749221074562632604234177943343278077904702528736427935263135224534360535648506531874889780445861931290681372159059998963956123292800662931972017853808929834759214901077820593022846983572643743611001443629925722754981107530356323168210971012649746503352214405631226915894475840184027954749807147519288265050591662983801362858402383872990077594394357755864916337555029291371894590405200288935921484820927991675070242278830865057283915878926407368038792299867598097690000059664234694536427968766494778571019419802228762318904528392586008185684728091795941702269868367952035937352981950415828358886770525954470082251084510027941785605230286162006284697134119953016234421686746655355134006563841365456960101247077980165688578201389779673986863179864152299106378472217609630609794259847064658398167415424080276282710600679919563427993041278094305098328452562295381*I)*q_1^2 
+ (1.35429208493086052685346697129252192911295560505832694588890385369845935914759241252801663016847804998408806057447577853901309193407569245685575355495825621213439112417009239312956627837673804716545069132325267145922112597325524244659508061648510774526131845770515951488355606023452789476789654660616968623668030454241713427458247222864031051449999473286097834871505190310175078552013062487413155339182408635063310295315640284119991273070670322231185641301716722796994718708658822853529574504717202120087715634763424274962329123483461568296022257017023981450338465569919112063918042476700454021571171392482030319188836206919329803242195326633811637297253235487607751302250431320886381647212809702643152087561994984182249331503369542724758321007731386241330707705220946682121888543368358228612562325093075802578898941913821914982470062657123694012280941253428988753213467353262898239560386326402929813951118592433673882917967440359020916726667979115432611887029361669281497844588174502334233904813995 + 6.12246423496974006185614477885272567176745705888252123208952418877993155509740125665131331077503565236148081744580467529291376423106062734386452371317374766333752568364843953008234982250409405815138409841790537432345661999418660072812885115537811992387283828777865862983314801545830187201110845069318404334356811042626772011273784282368397049057890356631628030271888182958330461913203104116828531725007019825385323990249296993078614222419819473419754513768170314854475904772172582279773066267602988081971272488261394607768032054382038940495847396661162902158036823347579768330722899525248662831135830829221777939666697567980678414224549739851377138612122324424485742287053559075444924135768443480033939024848455804723313188322845604813263346692916116087667378748510471644100744623241769330718758374643109761351611638381564964109076278011208506544036289415830683326743819057100354222187486382601697169972890177386445395288317399936042147878617887885549384974606673077543110914720213649457922944284974*I)*q_1^3 + (-13.6006363034471046719715714108119334153261359036871396145200134549862033423646575010446288911033306832979848811801025960367458178086217328219136404533698943330195187575186092645050932790708519536351352855364016589896513936300232415438027401305754921019962457262025455918730937033954619038927234418724352625885491423734615491866183839685344955552440373936073990288468273243026975810406099877887355466896643250738231623673463935121829439107173574260933002493605509618325610351497900054884746238376349501261905429207927606124377900571821803082353484865896894180025174977326167006288654572457263112985251879040087732608417090964211261621873666285363609141819550534056273551379927226317577621590439283615861157961397384042538218791718380028160926101287126871734025007563678865382857904158697860868970793624242741070434794820398140221983513780023624736532388866119581798776670561795728130912640641374323778796488700954610733179620656975203998770989421175576731885631480413342037971996581144374366372229073 - 21.6947856813712743243228731803624399319759370454814692331065634955468550306583004107215677576987504005274350647548419756133998890646049348181467291854808602203693109775302238629357727626886303357196640301425786879452227175528258431686753732642376789223824971217718662960833262743203128008501116808085861823507633039684530814698959521450230201791664334165073881473216936161841545107966802658590527414437884115927096500922613098640296629170821694289330560583535597299193750169103998329458739892982196924580076593755760985196491964703439773750833013136032170635214310877519014933012318575543517424747048265082749948991231291070370099862483010529399885177606776298030713521568526791981096264397577805954214579815090429346656231062754017150859778273684849980641054670912557673887838976900224324944037942759128667093095951066234229954843335031791454106155373117532527785869403613174277247151154202018795671850384281432857137551098351710392539824788489115070141473502604244593364135864599623340712989247717*I)*q_1^4 + O(q_1^5)
```
Interestingly, all of these coefficients seem to be non-algebraic!  
Note that in order to get coefficients beyond degree 50, one can also use `modforms_float` as a basis.
